# 浏览器显示问题排查报告

**日期**: 2026-02-21  
**问题**: 浏览器窗口打开但无内容显示

---

## ✅ 已确认正常的部分

1. **服务状态**: ✅ 正常运行
   - 端口: 3000
   - 进程ID: 可通过 `ps aux | grep tsx` 查看
   - 日志: `/tmp/server_manual.log`

2. **HTTP响应**: ✅ 正常
   ```bash
   curl -I http://localhost:3000
   # 返回: HTTP/1.1 200 OK
   ```

3. **HTML内容**: ✅ 正常加载
   - Vite客户端脚本已注入
   - React运行时已加载
   - Manus调试工具已启用

4. **前端资源**: ✅ 可访问
   - `/@vite/client` - 正常
   - `/@react-refresh` - 正常
   - `/__manus__/debug-collector.js` - 正常

---

## 🔍 可能的原因

### 1. IDE预览窗口刷新延迟
**现象**: 窗口打开但内容未加载  
**原因**: IDE的预览功能可能有缓存或初始化延迟  
**解决方案**: 
- 在IDE预览窗口中点击"刷新"按钮
- 或者直接在系统浏览器中访问 http://localhost:3000

### 2. JavaScript执行错误
**现象**: HTML加载但页面空白  
**原因**: 前端代码可能有运行时错误  
**解决方案**: 打开浏览器开发者工具查看Console

### 3. Vite HMR连接失败
**现象**: 初次加载慢或不完整  
**原因**: Vite的热更新WebSocket连接可能失败  
**解决方案**: 等待10-15秒让Vite完全启动

---

## 🛠️ 推荐解决方案

### 方案A：在系统浏览器中直接打开（最可靠）
```bash
# 1. 确认服务运行中
curl -I http://localhost:3000

# 2. 在系统浏览器中访问
# Chrome/Firefox: 直接打开 http://localhost:3000
```

### 方案B：检查浏览器控制台
1. 在IDE预览窗口中，按 `F12` 或右键点击 "检查元素"
2. 切换到 "Console" 标签页
3. 查看是否有红色错误信息
4. 截图错误信息以便进一步诊断

### 方案C：重启服务并等待完全启动
```bash
# 1. 运行启动脚本
/home/home_dev/workspace/9.Mineru2Questions/start_server.sh

# 2. 等待15秒
sleep 15

# 3. 验证服务完全就绪
curl http://localhost:3000 | grep "react"
```

---

## 📋 验证清单

运行以下命令验证各组件状态：

```bash
# 1. 检查进程
ps aux | grep tsx | grep server

# 2. 检查端口
lsof -i :3000 || curl -I http://localhost:3000

# 3. 检查日志
tail -50 /tmp/server_manual.log | grep -E "(Server running|error|Error)"

# 4. 检查Vite
curl -s http://localhost:3000/@vite/client | head -5

# 5. 测试API
curl http://localhost:3000/api/trpc/llmConfig.list
```

---

## 💡 下一步建议

**如果IDE预览窗口仍然空白**：
1. 尝试在系统浏览器（Chrome/Firefox）中直接访问 http://localhost:3000
2. 这样可以排除是IDE预览功能的问题

**如果系统浏览器也是空白**：
1. 检查浏览器控制台的错误信息
2. 查看网络标签页，确认所有资源是否加载成功
3. 检查 `/tmp/server_manual.log` 的完整日志

---

## 🚀 快速测试方案

如果浏览器显示问题一直无法解决，可以使用 **命令行API测试** 来验证修复：

```bash
# 测试1: 创建错误LLM配置
curl -X POST http://localhost:3000/api/trpc/llmConfig.create \
  -H "Content-Type: application/json" \
  -d '{"name":"测试失败","apiUrl":"https://invalid.com","apiKey":"test","modelName":"test","usage":"long_context"}'

# 测试2: 创建任务（使用错误LLM）
# （需要先获取LLM配置ID，然后创建任务）

# 测试3: 观察任务状态
curl http://localhost:3000/api/trpc/task.list
```

这样即使浏览器有问题，也能通过API验证P0修复是否有效。
