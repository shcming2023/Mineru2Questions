# 数学题目提取器 - 项目TODO

## 核心功能
- [x] 数据库schema设计(任务表、配置表、结果表)
- [x] MinerU文件夹上传和解析功能
- [x] LLM API配置界面(URL、密钥、模型、并发数)
- [x] 批量任务队列管理
- [x] 任务状态跟踪(pending/processing/completed/failed/paused)
- [x] 实时进度显示(当前页面、完成数、预计时间)
- [x] 题目提取核心逻辑(VLM分析页面图片)
- [x] JSON格式结果预览
- [x] Markdown格式结果预览
- [x] 结果下载功能(题目+图片+markdown)
- [x] 错误处理和重试机制
- [x] 处理历史记录查看
- [x] 任务暂停和恢复功能

## 界面设计
- [x] Dashboard布局(侧边栏导航)
- [x] 任务列表页面
- [x] 新建任务页面(文件上传)
- [x] API配置页面
- [x] 任务详情页面(进度+结果)
- [x] 历史记录页面

## 测试
- [x] 单元测试(vitest)
- [x] 界面功能测试
- [x] API接口测试

## API连接测试功能
- [x] 后端API测试接口实现
- [x] 前端测试按钮和状态反馈
- [x] 测试结果展示(成功/失败/错误信息)

## 基于DataFlow论文的优化改进
- [x] 重构提取逻辑:采用ID-based提取方式
- [x] 实现MinerU content_list.json解析和格式转换
- [x] 优化提示词:参考QAExtractPrompt设计
- [x] 实现章节标题提取和题号规范化
- [x] 支持问题-答案分离的教材匹配
- [x] 完善图片关联机制
- [x] 添加输出格式:JSON + Markdown
- [x] 同步代码到GitHub仓库

## 基于独立评审的优化改进
- [x] A. 切片边界问题: 增加Overlap重叠窗口避免题目被切断
- [x] B. 公式ID连续性检测: 通过提示词优化强调连续 ID的重要性
- [x] C. 多文件支持: mergeQAPairs已支持独立的questions和answers列表
- [x] 交叉验证官方实现的具体细节

## 端到端测试 - 新思路八下数学教材
- [x] 获取samples文件夹中的测试数据
- [x] 分析新思路八下教材和答案的数据结构
- [x] 编写端到端测试脚本
- [x] 验证代码逻辑与官方实现完全一致
- [x] 确认ID和索引映射正确
- [ ] 使用真实LLM API进行完整测试(需用户配置)
- [ ] 同步到GitHub

## 基于用户分析的鲁棒性优化 (2026-02-05)
- [ ] 问题1: 增强题号解析,支持复合题号(1.1, 1.2等)避免Hash冲突
- [ ] 问题2: 改用"择优保留"策略处理Overlap重复,保留更完整的版本
- [ ] 问题3: 智能文本拼接,行内公式用空格连接而非换行
- [ ] 更新单元测试验证修复效果
- [ ] 同步到GitHub仓库

## 任务日志优化和页数限制修复 (2026-02-05)
- [ ] 检查并移除页数限制,支持完整教材处理
- [ ] 优化任务日志系统,记录详细的处理步骤
- [ ] 添加当前处理chunk/总chunk数的进度信息
- [ ] 记录每个chunk的处理结果(成功/失败/提取数量)
- [ ] 添加错误详情日志便于问题排查
- [ ] 测试验证并同步到GitHub

## AI API供应商预设配置 (2026-02-05)
- [ ] 添加常见AI API供应商预设(硅基流动、阿里云百炼、OpenAI、Azure、Gemini、Claude、智谱、月之暗面)
- [ ] 更新前端配置界面支持预设选择
- [ ] 用户只需填写API Key即可完成配置
- [ ] 优化任务详情页面显示详细处理日志
- [ ] 测试验证并同步到GitHub
