You are a document structure analyst specializing in educational textbooks. Your task is to identify the table of contents (chapter/section structure) from a list of candidate headings.

## Input Format
You will receive a JSON array of candidate headings. Each entry has one of two formats:

**Single-instance** (appears once in the document):
`{"id": 123, "text": "Chapter 1", "page": 5}`

**Multi-instance** (same text appears multiple times):
`{"text": "Chapter Review", "instances": [{"id": 500, "page": 30}, {"id": 900, "page": 60}], "count": 2}`

For multi-instance entries, you must decide:
- Are ALL instances real structural headings? (e.g., "Chapter Review" appearing once per chapter → include all instance IDs)
- Are NONE of them real headings? (e.g., "Key Point" appearing on every page → exclude all)
- Are only SOME real? (e.g., first instance is a TOC entry, rest are body headings → include only body instances)

## Your Task
1. Identify which candidates are actual chapter/section headings
2. Organize them into a **two-level hierarchy**: Level 1 (chapters/units/parts) and Level 2 (sections/lessons/topics)
3. Output the specific `id` of each selected heading instance

## Critical Rules

### What to EXCLUDE
1. **TOC page entries**: Entries on the first few pages that list chapter titles with page numbers. Keep only the body instances.
2. **Page headers/footers**: Text appearing on every/most pages (high instance count, not structural).
3. **Repeated instructional labels**: Labels like "Key Point", "Summary", "Practice", "Read", "Listen" that appear in every chapter as activity markers, NOT as structural divisions.

### What to INCLUDE
1. **Chapter/Unit headings**: Top-level divisions (e.g., "Chapter 19", "Unit 5", "TOPIC 3").
2. **Section/Lesson headings**: Second-level divisions (e.g., "19.1 Square Roots", "Lesson 3-1").
3. **Functional headings with unique identifiers**: Even if the base label repeats, each instance with a unique identifier is a distinct structural boundary (e.g., "Stage Training ①" and "Stage Training ②" are different headings — include both). For multi-instance entries like "Chapter Review" that appear once per chapter, include ALL instance IDs.

### Key distinction for multi-instance entries
- "Chapter Review" appearing 4 times (once per chapter) → **INCLUDE all 4 IDs** (each is a real structural boundary)
- "Key Point" appearing 37 times → **EXCLUDE all** (instructional label, not structure)
- The key signal: structural headings typically appear a small number of times (matching the number of chapters), while noise labels appear many more times.

### Ordering and merging
- Selected headings MUST be in document order (ascending page/id).
- If a heading is split across consecutive blocks (e.g., id=100 "Final Exam" + id=101 "Paper A"), merge using an array: [100, 101].

### Thoroughness
- Identify ALL structural headings. Do not skip any.

## Output Format
Return ONLY a JSON object:
{
  "chapters": [
    {
      "id": <number or [number, number]>,
      "level": 1,
      "children": [
        { "id": <number or [number, number]>, "level": 2 },
        ...
      ]
    },
    ...
  ]
}

---

Here are 117 candidate heading groups from an educational textbook:

[{"text":"新思路","instances":[{"id":0,"page":0},{"id":17,"page":1}],"count":2},{"text":"辅导与训练","instances":[{"id":3,"page":0},{"id":12,"page":1},{"id":42,"page":2},{"id":51,"page":3},{"id":74,"page":5}],"count":5},{"text":"数学","instances":[{"id":4,"page":0},{"id":13,"page":1}],"count":2},{"id":9,"text":"上海市教辅畅销品牌","page":0},{"id":19,"text":"内容提要","page":2},{"id":21,"text":"图书在版编目（CIP）数据","page":2},{"id":44,"text":"出版说明","page":3},{"id":60,"text":"目录","page":5},{"text":"第19章 实数","instances":[{"id":61,"page":5},{"id":129,"page":9}],"count":2},{"id":62,"text":"19.1 平方根与立方根 1","page":5},{"id":64,"text":"阶段训练1 11","page":5},{"id":65,"text":"19.2 实数 13","page":5},{"id":67,"text":"本章复习题(一) 32","page":5},{"id":68,"text":"本章复习题(二) 35","page":5},{"id":69,"text":"第20章 二次根式 … 38","page":5},{"id":70,"text":"20.1 二次根式及其性质 38","page":5},{"id":72,"text":"20.2 二次根式的运算 47","page":5},{"id":80,"text":"第21章 一元二次方程 75","page":6},{"id":92,"text":"第22章 直角三角形 140","page":7},{"id":93,"text":"22.1 直角三角形 140","page":7},{"id":95,"text":"22.2角平分线 148","page":7},{"id":97,"text":"阶段训练7 156","page":7},{"id":98,"text":"22.3 勾股定理 160","page":7},{"id":100,"text":"阶段训练8 168","page":7},{"id":102,"text":"阶段训练9 180","page":7},{"id":103,"text":"本章复习题 184","page":7},{"id":104,"text":"期末测试卷A卷 189","page":7},{"id":105,"text":"期末测试卷B卷 195","page":7},{"id":106,"text":"附：","page":7},{"id":107,"text":"参考答案","page":7},{"id":109,"text":"19.1 平方根与立方根","page":9},{"id":110,"text":"19.1(一) 算术平方根","page":9},{"text":"要点归纳","instances":[{"id":112,"page":9},{"id":157,"page":11},{"id":223,"page":15},{"id":305,"page":21},{"id":357,"page":24},{"id":409,"page":27},{"id":457,"page":30},{"id":525,"page":34},{"id":575,"page":37},{"id":711,"page":46},{"id":770,"page":49},{"id":889,"page":55},{"id":1038,"page":64},{"id":1082,"page":67},{"id":1157,"page":71},{"id":1274,"page":83},{"id":1333,"page":86},{"id":1390,"page":90},{"id":1447,"page":94},{"id":1513,"page":98},{"id":1561,"page":102},{"id":1649,"page":109},{"id":1703,"page":112},{"id":1751,"page":116},{"id":1812,"page":119},{"id":1870,"page":124},{"id":1993,"page":131},{"id":2042,"page":134},{"id":2089,"page":138},{"id":2210,"page":148},{"id":2272,"page":152},{"id":2334,"page":156},{"id":2420,"page":161},{"id":2522,"page":168},{"id":2571,"page":171},{"id":2688,"page":179},{"id":2770,"page":183}],"count":37},{"text":"疑难分析","instances":[{"id":115,"page":9},{"id":160,"page":11},{"id":227,"page":15},{"id":313,"page":21},{"id":360,"page":24},{"id":414,"page":27},{"id":460,"page":30},{"id":530,"page":34},{"id":580,"page":37},{"id":714,"page":46},{"id":773,"page":49},{"id":892,"page":55},{"id":1042,"page":64},{"id":1085,"page":67},{"id":1160,"page":71},{"id":1277,"page":83},{"id":1336,"page":86},{"id":1393,"page":90},{"id":1450,"page":94},{"id":1516,"page":98},{"id":1564,"page":102},{"id":1652,"page":109},{"id":1706,"page":112},{"id":1754,"page":116},{"id":1815,"page":119},{"id":1873,"page":124},{"id":1996,"page":131},{"id":2045,"page":134},{"id":2092,"page":138},{"id":2213,"page":148},{"id":2275,"page":152},{"id":2337,"page":156},{"id":2423,"page":161},{"id":2525,"page":168},{"id":2574,"page":171},{"id":2691,"page":179},{"id":2773,"page":183}],"count":37},{"text":"基础训练","instances":[{"id":134,"page":10},{"id":190,"page":12},{"id":332,"page":22},{"id":381,"page":25},{"id":436,"page":28},{"id":500,"page":32},{"id":544,"page":34},{"id":601,"page":37},{"id":735,"page":47},{"id":809,"page":50},{"id":924,"page":56},{"id":1059,"page":65},{"id":1107,"page":68},{"id":1189,"page":72},{"id":1299,"page":84},{"id":1367,"page":87},{"id":1417,"page":91},{"id":1477,"page":95},{"id":1535,"page":99},{"id":1591,"page":103},{"id":1680,"page":110},{"id":1725,"page":112},{"id":1787,"page":117},{"id":1846,"page":120},{"id":1902,"page":125},{"id":2016,"page":131},{"id":2071,"page":135},{"id":2113,"page":139},{"id":2240,"page":149},{"id":2310,"page":153},{"id":2380,"page":158},{"id":2460,"page":162},{"id":2552,"page":169},{"id":2615,"page":173},{"id":2721,"page":180},{"id":2811,"page":184}],"count":36},{"text":"拓展训练","instances":[{"id":152,"page":10},{"id":218,"page":14},{"id":269,"page":18},{"id":352,"page":23},{"id":404,"page":26},{"id":453,"page":29},{"id":521,"page":33},{"id":570,"page":36},{"id":632,"page":39},{"id":765,"page":48},{"id":873,"page":53},{"id":968,"page":60},{"id":1077,"page":66},{"id":1152,"page":70},{"id":1206,"page":74},{"id":1327,"page":85},{"id":1386,"page":89},{"id":1436,"page":92},{"id":1507,"page":97},{"id":1555,"page":101},{"id":1610,"page":105},{"id":1697,"page":111},{"id":1743,"page":115},{"id":1797,"page":118},{"id":1859,"page":122},{"id":1934,"page":127},{"id":2082,"page":137},{"id":2119,"page":140},{"id":2265,"page":151},{"id":2326,"page":155},{"id":2412,"page":160},{"id":2475,"page":163},{"id":2509,"page":166},{"id":2564,"page":170},{"id":2634,"page":175},{"id":2762,"page":182},{"id":2855,"page":187}],"count":37},{"id":155,"text":"19.1(二) 平方根","page":11},{"id":221,"text":"19.1(三) 立方根","page":15},{"id":245,"text":"自基础训练","page":16},{"id":276,"text":"阶段训练 ①","page":19},{"id":302,"text":"19.2 实数","page":21},{"id":303,"text":"19.2（一） 有理数的小数形式","page":21},{"id":355,"text":"19.2（二） 无理数","page":24},{"id":407,"text":"19.2(三) 实数与数轴","page":27},{"id":455,"text":"19.2（四） 实数的绝对值和大小比较","page":30},{"id":523,"text":"19.2(五) 实数的运算","page":34},{"id":573,"text":"19.2(六） 科学记数法","page":37},{"id":634,"text":"本章复习题（一）","page":40},{"id":663,"text":"本章复习题（二）","page":43},{"id":708,"text":"20.1 二次根式及其性质","page":46},{"id":709,"text":"20.1(一) 二次根式的概念","page":46},{"id":727,"text":"第20章 二次根式","page":46},{"id":768,"text":"20.1(二） 二次根式的性质及最简二次根式","page":49},{"id":886,"text":"20.2 二次根式的运算","page":55},{"id":887,"text":"20.2（一）同类二次根式及二次根式的加减法","page":55},{"id":972,"text":"阶段训练②","page":61},{"id":1036,"text":"20.2（二） 二次根式的乘法和除法","page":64},{"id":1080,"text":"20.2(三） 分母有理化","page":67},{"id":1155,"text":"20.2（四） 二次根式的混合运算","page":71},{"id":1211,"text":"阶段训练③","page":76},{"text":"本章复习题","instances":[{"id":1228,"page":79},{"id":2173,"page":144},{"id":2900,"page":192}],"count":3},{"text":"一、填空题","instances":[{"id":1229,"page":79},{"id":2155,"page":144},{"id":2901,"page":192}],"count":3},{"text":"二、选择题","instances":[{"id":1251,"page":80},{"id":2157,"page":144},{"id":2918,"page":193}],"count":3},{"text":"三、解答题","instances":[{"id":1263,"page":80},{"id":2185,"page":145},{"id":2931,"page":194}],"count":3},{"id":1271,"text":"第21章 一元二次方程","page":83},{"id":1272,"text":"21.1 一元二次方程的概念","page":83},{"id":1330,"text":"21.2 一元二次方程的解法","page":86},{"id":1331,"text":"21.2(一）特殊的一元二次方程的解法——因式分解法","page":86},{"id":1388,"text":"21.2（二）用开平方的方法解特殊的一元二次方程","page":90},{"id":1445,"text":"21.2(三） 一般的一元二次方程的解法——配方法","page":94},{"id":1511,"text":"21.2（四） 一般的一元二次方程的解法——公式法","page":98},{"id":1559,"text":"21.2(五） 用合适的方法解一元二次方程","page":102},{"id":1614,"text":"阶段训练④","page":106},{"id":1646,"text":"21.3 一元二次方程的判别式","page":109},{"id":1647,"text":"21.3(一） 一元二次方程的根的判别式","page":109},{"id":1701,"text":"21.3(二） 一元二次方程的根的判别式的应用","page":112},{"id":1748,"text":"21.4 一元二次方程的根与系数的关系","page":116},{"id":1749,"text":"21.4(一） 一元二次方程的根与系数的关系(1)","page":116},{"id":1810,"text":"21.4(二） 一元二次方程的根与系数的关系(2)","page":119},{"id":1867,"text":"21.5 一元二次方程的应用","page":124},{"id":1868,"text":"21.5(一) 二次三项式的因式分解","page":124},{"id":1939,"text":"阶段训练 5","page":128},{"id":1991,"text":"21.5(二) 列方程解实际问题","page":131},{"id":2040,"text":"21.5(三） 解分式方程","page":134},{"id":2087,"text":"21.5（四） 列分式方程解应用题","page":138},{"id":2122,"text":"阶段训练 ⑥","page":141},{"id":2207,"text":"22.1 直角三角形","page":148},{"id":2208,"text":"22.1(一) 直角三角形的性质","page":148},{"id":2221,"text":"第22章 直角三角形","page":148},{"id":2270,"text":"22.1（二） 直角三角形全等的判定","page":152},{"id":2331,"text":"22.2 角平分线","page":156},{"id":2332,"text":"22.2（一） 角平分线性质定理","page":156},{"id":2418,"text":"22.2（二） 角平分线的综合运用","page":161},{"id":2479,"text":"阶段训练⑦","page":164},{"id":2519,"text":"22.3 勾股定理","page":168},{"id":2520,"text":"22.3(一) 勾股定理的证明","page":168},{"id":2569,"text":"22.3(二) 勾股定理的应用","page":171},{"id":2638,"text":"阶段训练⑧","page":176},{"id":2686,"text":"22.3(三) 勾股定理的逆定理及其证明","page":179},{"id":2768,"text":"22.3（四） 勾股定理及其逆定理的应用","page":183},{"id":2864,"text":"阶段训练⑨","page":188},{"text":"期末测试卷","instances":[{"id":2952,"page":197},{"id":3033,"page":203}],"count":2},{"id":2953,"text":"一、填空题（共15小题，每题2分，共30分）","page":197},{"id":2970,"text":"A卷","page":197},{"id":2975,"text":"二、选择题（共4小题，每题2分，共8分）","page":198},{"id":2998,"text":"三、计算题（共4小题，每题4分，共16分）","page":198},{"id":3008,"text":"五、综合题（共2小题，第28题8分，第29题10分，共18分）","page":200},{"id":3010,"text":"“平方和”等式宝塔的构建","page":200},{"id":3034,"text":"一、填空题（共16小题，每题2分，共32分）","page":203},{"id":3050,"text":"B卷","page":203},{"id":3056,"text":"二、选择题（共5小题，每题2分，共10分）","page":204},{"id":3079,"text":"三、解答题（共4小题，第22题6分，第23题6分，第24题8分，第25题8分，共28分）","page":205},{"id":3102,"text":"辅导得当，训练有素","page":209},{"id":3104,"text":"新思路辅导与训练","page":209},{"id":3112,"text":"世纪出版","page":209},{"id":3113,"text":"责任编辑 杨铮园","page":209},{"id":3114,"text":"美术编辑 诸梦婷","page":209}]